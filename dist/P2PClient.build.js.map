{"version":3,"file":"P2PClient.build.js","sources":["../src/settings.js","../src/Evented.js","../src/peerDatabaseUtils.js","../src/P2PClient.js"],"sourcesContent":["export var settings = {\n    // Get a reference to the database service\n\n    // Was having a bug where the WIFI router would crash if the chunk size was bigger than 2^10\n    CHUNK_SIZE: Math.pow(2, 14), // size in bytes of the chunks. 2^14 is just under the limit in chrome.\n    ICE_SERVERS: [\n        {\n            url: 'stun:23.21.150.121',\n            urls: 'stun:23.21.150.121',\n        },\n        {\n            url: 'turn:global.turn.twilio.com:3478?transport=udp',\n            username:\n                '508d1e639868dc17f5da97a75b1d3b43bf2fc6d11e4e863678501db568b5665c',\n            credential: 'W5GTdhQQ6DqOD7k6bS8+xZVNQXm+fgLXSEQpN8bTe70=',\n            urls: 'turn:global.turn.twilio.com:3478?transport=udp',\n        },\n    ],\n    POLLING_FREQUENCY: 15000,\n    debug: false,\n}\n","/**\n * Evented\n */\n\nexport class Evented {\n    constructor() {\n        this.events = {}\n    }\n\n    on(eventName, callback) {\n        if (typeof callback !== 'function') return\n        if (!this.events.hasOwnProperty(eventName)) {\n            this.events[eventName] = []\n        }\n        this.events[eventName].push(callback)\n    }\n\n    off(eventName, callback) {\n        if (this.events.hasOwnProperty(eventName)) {\n            if (typeof callback === 'function') {\n                //_.without(this.events[eventName], callback);\n                this.events = this.events.filter(function (x) {\n                    if (x != this.events[eventName]) {\n                        return x\n                    }\n                })\n            } else {\n                delete this.events[eventName]\n            }\n        }\n    }\n\n    fire(eventName, argument) {\n        //_.each(this.events[eventName], (cb) => setTimeout(() => cb(argument)));\n        if (this.events[eventName]) {\n            for (var cb of this.events[eventName]) {\n                setTimeout(() => cb(argument))\n            }\n        }\n    }\n\n    fireAll(argument) {\n        for (var k in this.events) {\n            this.fire(k, argument)\n        }\n    }\n}\n","/**\n *\n * @param {*} database\n * @param {*} callback\n */\nexport function getPeerList(database, callback, firebase) {\n    console.log('getPeerList: ', database)\n    firebase.onValue(\n        database,\n        (ev) => {\n            var val = ev.val()\n            callback(null, val)\n        },\n        {\n            onlyOnce: true,\n        }\n    )\n}\n","import { settings } from './settings.js'\nimport { Evented } from './Evented.js'\nimport { getPeerList as _getPeerList } from './peerDatabaseUtils.js'\n\nexport function P2PClientFactory(options) {\n    const { PeerBinary } = options\n\n    return class P2PClient extends Evented {\n        constructor(options = {}) {\n            super()\n\n            if (!options.firebase)\n                throw new Error('firebase must be passed in the options object')\n\n            if (!options.database)\n                throw new Error('database must be passed in the options object')\n\n            this.firebase = options.firebase\n\n            this.id = 'client_' + Math.floor(Math.random() * 100000)\n            this.myID = this.id\n            this.peerID = this.id\n\n            this.ackID = 0\n            this.ackCallbacks = {}\n\n            this.requestID = 0\n            this.requestCallbacks = {}\n\n            let combinedSettings = { ...settings, ...options }\n            if (combinedSettings.debug)\n                console.log('settings: ', {\n                    settings,\n                    options,\n                    combinedSettings,\n                })\n            Object.assign(this, combinedSettings)\n\n            this.iceServers =\n                options.iceServers ||\n                options.ICE_SERVERS ||\n                settings.ICE_SERVERS\n\n            if (options.database) {\n                this.database = options.database\n            }\n\n            this.connection = null\n            this.channelRef = null\n            this.stream = undefined\n            this.isStream =\n                typeof options.isStream === 'boolean' ? options.isStream : true\n            this.connectionCallbacks = []\n            this.lastNegotiationState = undefined\n            this.debug = !!options.debug\n\n            this.PER_CHUNK_WAIT = options.PER_CHUNK_WAIT\n        }\n\n        getPeerList(callback) {\n            if (this.debug) console.log('Database: ', this.database)\n            return _getPeerList(this.database, callback, this.firebase)\n        }\n\n        ackCallback(ackID, data) {\n            if (this.debug) console.log('ackCallback: ', { ackID, data })\n            let { callback, timeoutID } = this.ackCallbacks[ackID] || {}\n            if (callback) {\n                clearTimeout(timeoutID)\n                callback(data)\n                delete this.ackCallbacks[ackID]\n            } else {\n                console.warn('Got ackID without a callback registered.', data)\n            }\n        }\n\n        sendAck(message, callback = () => {}, timeout = 30000) {\n            if (!this.connection) {\n                console.warn('no connection')\n                return\n            }\n\n            this.ackID += 1\n            let ackID = this.ackID\n\n            let timeoutID = setTimeout(() => {\n                this.ackCallback(ackID, { error: 'timeout' })\n            }, timeout)\n\n            this.ackCallbacks[ackID] = { callback, timeoutID }\n\n            return this.connection.sendBig({\n                type: 'ack',\n                data: {\n                    ackID: this.ackID,\n                    peerID: this.serverID,\n                    startDate: new Date().getTime(),\n                    message,\n                },\n            })\n        }\n\n        requestCallback(requestID, data) {\n            if (this.debug)\n                console.log('requestCallback: ', { requestID, data })\n            let { callback, timeoutID } = this.requestCallbacks[requestID] || {}\n\n            if (callback) {\n                clearTimeout(timeoutID)\n                callback(data)\n                delete this.requestCallbacks[requestID]\n            } else {\n                console.warn(\n                    'Got requestID without a callback registered.',\n                    data\n                )\n            }\n        }\n\n        sendRequest(request, callback = () => {}, timeout = 30000) {\n            if (!this.connection) {\n                console.warn('no connection')\n                return\n            }\n\n            this.requestID += 1\n            let requestID = this.requestID\n\n            let timeoutID = setTimeout(() => {\n                this.requestCallback(requestID, { error: 'timeout' })\n            }, timeout)\n\n            this.requestCallbacks[requestID] = { callback, timeoutID }\n\n            request.requestID = requestID\n            if (this.debug) console.log('sending request: ', request)\n\n            return this.connection.sendBig(request)\n        }\n\n        connectToPeerID(id, callback = () => {}) {\n            this.connectionCallbacks.push(callback)\n            this.serverID = id\n            this.getPeerList((err, peerList) => {\n                if (err) {\n                    console.error(err)\n                    this._notifyCallbacks(\n                        `Got error requesting peer list: ${err}`\n                    )\n                    return\n                }\n                var peer = peerList[id]\n                if (!peer) {\n                    console.error(`peer not defined. id: ${id}`)\n                    this._notifyCallbacks('peer not defined')\n                } else {\n                    this.id = id\n                    this.serverRef = this.firebase.child(this.database, id)\n                    this.firebase.onValue(\n                        this.serverRef,\n                        (ev1) => {\n                            var sval = ev1.val()\n                            let pOpts = {\n                                initiator: true,\n                                trickle: true,\n                                config: {\n                                    iceServers: this.iceServers,\n                                },\n                                peerID: id,\n                            }\n\n                            if (this.isStream) {\n                                pOpts.stream = this.getMyStream()\n                            }\n\n                            if (\n                                this.PER_CHUNK_WAIT ||\n                                this.PER_CHUNK_WAIT === 0\n                            ) {\n                                pOpts.PER_CHUNK_WAIT = this.PER_CHUNK_WAIT\n                            }\n\n                            var p = new PeerBinary(pOpts)\n                            this.connection = p\n                            this._registerEvents()\n                            p.on('signal', (data) => {\n                                if (data.type == 'offer') {\n                                    this._createChannel(data)\n                                } else if (data.candidate) {\n                                    if (this.debug) {\n                                        console.log(\n                                            'client recieved candidate from webrtc',\n                                            data\n                                        )\n                                    }\n                                    this.firebase.push(this.outRef, data)\n                                } else {\n                                    console.warn(\n                                        'Client recieved unexpected signal through WebRTC:',\n                                        data\n                                    )\n                                }\n                            })\n                        },\n                        {\n                            onlyOnce: true,\n                        }\n                    )\n                }\n            })\n        }\n\n        getMyStream() {\n            if (this.stream) return this.stream\n\n            // create fake stream if no stream specified, and the server is in streaming mode.\n            //    because, at the moment, simple-peer must have a stream from the initiator.\n            let fakeCanvas = document.createElement('canvas')\n            fakeCanvas.width = fakeCanvas.height = 1\n            var fakeStream = fakeCanvas.captureStream()\n            return fakeStream\n        }\n\n        disconnect(callback) {\n            callback =\n                callback ||\n                function () {\n                    console.log('client disconnected from server', arguments)\n                }\n\n            if (this.serverRef) {\n                this.firebase.off(this.serverRef)\n            }\n            if (this.outRef) {\n                this.firebase.off(this.outRef)\n            }\n            if (this.inRef) {\n                this.firebase.off(this.inRef)\n            }\n            if (this.connection) {\n                this.connection.destroy(callback)\n            } else {\n                callback()\n            }\n            // QUESTION: should I also disconnect from the listeners to the events emitted by this class?\n            //     it would be this.off()\n        }\n\n        _createChannel(offer) {\n            offer.peerID = this.peerID\n            offer.myID = this.myID\n            if (this.debug)\n                console.log('Got create channel with offer: ', offer)\n            this.channelRef = this.firebase.push(\n                this.firebase.child(this.serverRef, 'channels'),\n                {\n                    fromClient: [offer],\n                }\n            )\n            this.outRef = this.firebase.child(this.channelRef, 'fromClient')\n            this.inRef = this.firebase.child(this.channelRef, 'fromServer')\n            this.firebase.onChildAdded(this.inRef, (ev) => {\n                var val = ev.val()\n                if (this.debug) console.log(val, 'channel message, client')\n                if (val.type === 'answer') {\n                    setTimeout(() => {\n                        let state =\n                            this.connection &&\n                            this.connection._pc &&\n                            this.connection._pc.signalingState\n                        if (state == this.lastNegotiationState) {\n                            if (this.debug)\n                                console.log(\n                                    'signalstate. skip nested negotiations'\n                                )\n                            return\n                        }\n                        if (this.debug) console.log('signal start negotiation')\n                        this.lastNegotiationState = state\n                        if (this.debug) console.log('answer', this)\n                        if (!this.connection.destroyed)\n                            this.connection.signal(val)\n                    }, 50) // a slight delay helps establish connection, I think.\n                } else if (val.candidate) {\n                    if (this.debug)\n                        console.log('client recieved candidate from firebase')\n                    setTimeout(() => {\n                        if (!this.connection.destroyed)\n                            this.connection.signal(val)\n                    }, 50)\n                } else {\n                    console.warn(\n                        val,\n                        'Client recieved unexpected signal through Firebase'\n                    )\n                }\n            })\n        }\n\n        _notifyCallbacks(err, connection) {\n            try {\n                for (var callback of this.connectionCallbacks) {\n                    callback(err, connection)\n                }\n                this.connectionCallbacks = []\n            } catch (err) {\n                console.warn(err)\n            }\n        }\n\n        _registerEvents() {\n            // fire events\n            this.connection.on('error', (err) => {\n                console.error('client: error', err)\n                this.fire('error', { peer: this.connection, err: err })\n            })\n            this.connection.on('connect', () => {\n                if (this.debug) console.log('client: client connected')\n                this._notifyCallbacks(null, this.connection)\n                this.fire('connect', { peer: this.connection })\n            })\n            this.connection.on('data', (data) => {\n                if (this.debug)\n                    console.log('client: recieved some data: ', data)\n                this.fire('data', { peer: this.connection, data: data })\n            })\n            this.connection.on('close', (data) => {\n                if (this.debug)\n                    console.log('connection closed', this.connection)\n                this.fire('close', { peer: this.connection })\n            })\n            this.connection.on('dataBig', (data) => {\n                if (data && data.type === 'ackack') {\n                    let { ackID } = data.data.ack\n                    this.ackCallback(ackID, data)\n                } else {\n                    // console.log('~~~ DataBig ~~~~')\n                    // console.log(data)\n                    let { requestID } = data || {}\n                    if (requestID) {\n                        this.requestCallback(requestID, data)\n                    }\n                    // console.log('~~~~~~~~~~~~~~~~')\n                    this.fire('dataBig', { peer: this.connection, data: data })\n                }\n            })\n            this.connection.on('stream', (stream) => {\n                if (this.debug)\n                    console.log('Client: connected to stream', stream)\n                this.fire('stream', { peer: this.connection, stream: stream })\n            })\n            this.connection._pc.addEventListener('signalingstatechange', () => {\n                if (this.debug)\n                    console.log(\n                        'signalState',\n                        this.connection &&\n                            this.connection._pc &&\n                            this.connection._pc.signalingState\n                    )\n            })\n        }\n    }\n}\n"],"names":["_getPeerList"],"mappings":"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"}